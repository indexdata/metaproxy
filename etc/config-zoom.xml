<?xml version="1.0"?>
<metaproxy xmlns="http://indexdata.com/metaproxy" version="1.0">
  <!-- Z39.50 proxy which relays to target specified in Init otherinfo 
  (VAL_RPOXY). If no target is given, it relays to target
  z3950.indexdata.dk -->
  <start route="start"/>
  <filters>
    <filter id="frontend" type="frontend_net">
      <threads>10</threads>
      <port>@:9000</port>
    </filter>
    <filter id="backend" type="zoom">
      <torus
            url="http://newmk2.indexdata.com/torus2/searchable.ebsco/records/?query=udb%3D%db"
            xsldir="."
      />
      <fieldmap cql="cql.anywhere"/>
      <fieldmap cql="cql.serverChoice"/>
      <fieldmap cql="dc.creator" ccl="au"/>
      <fieldmap cql="dc.title" ccl="ti"/>
      <fieldmap cql="dc.subject" ccl="su"/>
      <fieldmap cql="bash.isbn" ccl="isbn"/>
      <fieldmap cql="bash.issn" ccl="issn"/>
      <fieldmap cql="dc.date" ccl="date"/>
      <!-- 
	   I got some of the following CCL qualifier names from
	   http://catalog.pburglib.org/polaris/Help/PWbasicsearch6.html
	   These are marked with the comment POLARIS.
	   The others, I just made up.
	   (Mike, Wed Jun 15 22:50:18 BST 2011)
	-->
      <fieldmap cql="rec.identifier" ccl="ocn"/><!-- POLARIS -->
      <fieldmap cql="net.path" ccl="db"/>
      <fieldmap cql="dc.language" ccl="la"/><!-- POLARIS -->
      <fieldmap cql="dc.format" ccl="tom"/><!-- POLARIS -->
      <fieldmap cql="id.fullText" ccl="fullText"/>
      <fieldmap cql="id.peerReviewed" ccl="peerReviewed"/>
      <fieldmap cql="dc.description" ccl="desc"/>
      <fieldmap cql="dc.source" ccl="src"/>
      <fieldmap cql="dc.publisher" ccl="pub"/><!-- POLARIS -->
      <fieldmap cql="id.seriesTitle" ccl="series-ti"/>
    </filter>
  </filters>
  <routes>  
    <route id="start">
      <filter refid="frontend"/>
      <filter type="log">
        <message>F</message>
      </filter>
      <filter type="sru_z3950"/>
      <filter type="record_transform">
        <retrievalinfo   xmlns="http://indexdata.com/yaz" version="1.0">
          <retrieval syntax="xml" name="usi">
            <backend syntax="xml" name="pz2">
              <xslt stylesheet="../xml/xslt/pz22usi.xsl"/>
            </backend>
          </retrieval>
          <retrieval syntax="xml"/>
          <retrieval syntax="json"/>
          <retrieval syntax="usmarc"/>
        </retrievalinfo>
      </filter>
      <filter type="session_shared"/>
      <filter type="log">
        <message>B</message>
	<category apdu="true"/>
      </filter>
      <filter refid="backend"/>
      <filter type="bounce"/>
    </route>
  </routes>
</metaproxy>

