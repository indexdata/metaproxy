<?xml version="1.0"?>
<metaproxy xmlns="http://indexdata.com/metaproxy" version="1.0">
  <start route="start"/>
  <filters>
    <filter id="frontend" type="frontend_net">
      <threads>10</threads>
      <port>@:9000</port>
    </filter>
    <filter id="backend" type="zoom">
      <torus
         url="http://mk2.indexdata.com/torus2/searchable.usi-test/records/?query=udb%3D%db"
            xsldir="."
            element_transform="pz2"
            element_raw="raw"
	    proxy="localhost:3128"
	    >	
        <!-- these records are examples only -->
	<records>

          <!-- local z-target and content connector -->
	  <record>
	    <piggyback>1</piggyback>
	    <queryEncoding>UTF-8</queryEncoding>
	    <udb>z-local</udb>
	    <cclmap_term>1=1016 s=al</cclmap_term>
	    <cclmap_ti>1=4 s=pw t=l,r</cclmap_ti>
	    <requestSyntax>usmarc</requestSyntax>
	    <transform>tmarc.xsl</transform>
	    <urlRecipe>http://sever.com?title=${md-title[\s+/+/g]}</urlRecipe>
	    <zurl>localhost:9998/db01</zurl>
	    <contentConnector>heikki/content1</contentConnector>
	  </record>
	  <record>
	    <udb>heikki/content1</udb>
	    <zurl>localhost:9999/heikki/content1</zurl>
	    <cfAuth>cfuser/cfpassword</cfAuth>
	  </record>

          <!-- sru local connector -->
	  <record>
	    <piggyback>1</piggyback>
	    <queryEncoding>UTF-8</queryEncoding>
	    <udb>sru-local</udb>
	    <cclmap_term>s=al</cclmap_term>
	    <cclmap_ti>1=title s=pw t=l,r</cclmap_ti>
	    <sru>get</sru>
	    <transform>tmarc.xsl</transform>
	    <zurl>localhost:9998/db01</zurl>
	  </record>

          <!-- jstor -->
	  <record>
	    <piggyback>1</piggyback>
	    <queryEncoding>UTF-8</queryEncoding>
	    <udb>jstor-local</udb>
	    <cclmap_term>s=al</cclmap_term>
	    <cclmap_ti>1=title s=pw t=l,r</cclmap_ti>
	    <sru>get</sru>
	    <transform>dc.xsl</transform>
	    <zurl>dfr.jstor.org/sru</zurl>
	  </record>

          <!-- cf connector -->
	  <record>
	    <piggyback>1</piggyback>
	    <queryEncoding>UTF-8</queryEncoding>
	    <udb>cf-local</udb>
	    <cclmap_term>1=1016 s=al</cclmap_term>
	    <cclmap_ti>1=4 s=pw t=l,r</cclmap_ti>
	    <requestSyntax>xml</requestSyntax>
	    <transform>cf.xsl</transform>
	    <zurl>localhost:9999/db01</zurl>
	    <cfAuth>cfuser/cfpassword</cfAuth>
	    <cfProxy>localhost:3128</cfProxy>
	    <cfSubDb>mysub</cfSubDb>
	  </record>
	</records>
      </torus>
      <fieldmap cql="cql.anywhere"/>
      <fieldmap cql="cql.serverChoice"/>
      <fieldmap cql="dc.creator" ccl="au"/>
      <fieldmap cql="dc.title" ccl="ti"/>
      <fieldmap cql="dc.subject" ccl="su"/>
      <fieldmap cql="bath.isbn" ccl="isbn"/>
      <fieldmap cql="bath.issn" ccl="issn"/>
      <fieldmap cql="dc.date" ccl="date"/>
      <cclmap>
        <qual name="ocn">
          <attr type="1" value="12"/>
        </qual>
      </cclmap>
      <contentProxy
         server="hpxy.indexdata.com"
         tmp_file="/tmp/cf.XXXXXX.p"
      />
      <log apdu="true"/>
    </filter>
  </filters>
  <routes>  
    <route id="start">
      <filter refid="frontend"/>
      <filter type="log">
        <message>F</message>
      </filter>
      <filter type="sru_z3950"/>
      <filter type="session_shared"/>
      <filter type="log">
        <message>B</message>
	<category apdu="true"/>
      </filter>
      <filter refid="backend"/>
      <filter type="bounce"/>
    </route>
  </routes>
</metaproxy>

